# Intrusion Detection & Prevention System Lab with pfSense & Suricata

> A hands-on project demonstrating the deployment of the Suricata Intrusion Prevention System (IPS) on a pfSense firewall to detect, alert, and block common real-world cyber-attacks in a virtualized network environment.

## üéØ Project Objectives
- **Deploy a Multi-Layered Network:** Build a controlled, virtual network with distinct WAN and LAN zones using UTM.
- **Integrate an IDS/IPS:** Transform a standard pfSense firewall into an intelligent threat management gateway by integrating the Suricata engine.
- **Simulate Real-World Threats:** Execute common reconnaissance (Nmap) and web vulnerability scans (Nikto) from a dedicated attacker machine.
- **Validate Defensive Capabilities:** Verify Suricata's ability to not only detect simulated attacks but also to automatically block the attacker's IP address in real-time.
- **Perform Forensic Analysis:** Showcase the value of application-layer logging for incident analysis and threat intelligence.

## üõ†Ô∏è Tech Stack & Tools
- **Firewall & IDS/IPS:** pfSense, Suricata
- **Virtualization:** UTM (x86_64 Emulation on Apple Silicon)
- **Operating Systems:** Ubuntu Server (Victim), Kali Linux (Attacker)
- **Networking:** NAT Port Forwarding, Network Segmentation
- **Attack & Reconnaissance Tools:** Nmap, Nikto

## üèóÔ∏è Network Architecture
The lab consists of three virtual machines: an external **Attacker (Kali Linux)**, a **pfSense Firewall** acting as the gateway and IDS/IPS, and an internal **Victim Web Server (Ubuntu)** in a protected LAN zone.

![Network Topology](images/network-topology.png)

## ‚öôÔ∏è Configuration & Implementation

### 1. pfSense Firewall Setup
The firewall was configured with a WAN interface (bridged) and a LAN interface (host-only). A NAT Port Forwarding rule was created to allow external HTTP traffic (Port 80) to reach the internal Victim server.

![NAT Port Forwarding Rule](images/nat-port-forwarding-rule.png)

### 2. Suricata IDS/IPS Integration
Suricata was installed via the pfSense Package Manager and configured to run in **Intrusion Prevention System (IPS) mode** on the WAN interface. This allows it to inspect and drop malicious packets before they reach the internal network. The "Block Offenders" option was enabled to automatically block the source IP of any detected threat.

![Suricata in IPS Mode](images/suricata-ips-mode.png)

## ‚öîÔ∏è Attack Simulation & Results
Two common attack scenarios were simulated from the Kali Linux machine to validate the system's effectiveness.

### Test Case 1: Nmap Network Reconnaissance
An aggressive Nmap scan (`nmap -A [Firewall_IP]`) was launched to discover open ports and services.
- **Result:** Suricata immediately detected the scan as suspicious activity. The alerts log showed multiple events related to port scanning and Nmap Scripting Engine usage.

![Suricata Nmap Alerts](images/suricata-nmap-alerts.png)

### Test Case 2: Nikto Web Vulnerability Scan
A Nikto scan was run to identify common web application vulnerabilities on the victim server.
- **Result:** The scan triggered numerous high-priority alerts in Suricata, which recognized the attack patterns associated with directory traversal attempts and other web exploits.

![Suricata Nikto Alerts](images/suricata-nikto-alerts.png)

### Final Outcome: Real-Time Threat Neutralization
As a direct result of the alerts generated by both scans, Suricata's "Block Offenders" feature **automatically added the attacker's IP address to a block list**. This action effectively neutralized the threat in real-time, preventing the attacker from sending any further traffic to the network.

![Attacker IP Blocked by Suricata](images/suricata-blocked-ip.png)

## üí° Key Learnings
This project provided hands-on experience in deploying and managing a critical perimeter defense tool. I learned the practical differences between a stateless firewall and a stateful IDS/IPS, the importance of rule-set management, and how to analyze logs to understand attack vectors. This lab solidified my understanding of the defense-in-depth security strategy.
